#For Cornwall
cornwallBroadbandSpeedCleaned = inner_join(cwBroadbandSpeedPerf, cwBroadbandSpeedCov,
by = c("postcode", "postcode_space", "postcode area"))
View(cornwallBroadbandSpeedCleaned)
colSums(is.na(cornwallBroadbandSpeedCleaned))
dim(cornwallBroadbandSpeedCleaned)
cornwallBroadbandSpeedCleaned = cornwallBroadbandSpeedCleaned %>%
select(postcode, postcode_space, `postcode area`,
`Average download speed (Mbit/s)`, `Maximum download speed (Mbit/s)`, `Minimum download speed (Mbit/s)`,
`Average upload speed (Mbit/s)`, `Maximum upload speed (Mbit/s)`, `Minimum upload speed (Mbit/s)`,
`Average data usage (GB)`, `All Premises`, `Connected Premises`)
View(cornwallBroadbandSpeedCleaned)
dim(cornwallBroadbandSpeedCleaned)
#For Bristol and Cornwall
bcBroadbandSpeedCleaned = inner_join(bcBroadbandSpeedPerf, bcBroadbandSpeedCov,
by = c("postcode", "postcode_space", "postcode area"))
View(bcBroadbandSpeedCleaned)
colSums(is.na(bcBroadbandSpeedCleaned))
dim(bcBroadbandSpeedCleaned)
bcBroadbandSpeedCleaned = bcBroadbandSpeedCleaned %>%
select(postcode, postcode_space, `postcode area`,
`Average download speed (Mbit/s)`, `Maximum download speed (Mbit/s)`, `Minimum download speed (Mbit/s)`,
`Average upload speed (Mbit/s)`, `Maximum upload speed (Mbit/s)`, `Minimum upload speed (Mbit/s)`,
`Average data usage (GB)`, `All Premises`, `Connected Premises`)
View(bcBroadbandSpeedCleaned)
dim(bcBroadbandSpeedCleaned)
View(bcBroadbandSpeedCleaned)
#For postcode to LSOA code
pscdToLsoa = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/population/Postcode to LSOA.csv")
View(pscdToLsoa)
dim(pscdToLsoa)
colnames(pscdToLsoa)
print(unique(pscdToLsoa$lsoa11nm))
pscdToLsoa = pscdToLsoa %>%
rename(postcode_space = pcds) %>%
rename(lsoa_area = lsoa11nm) %>%
rename(city = ladnm) %>%
select(postcode_space, lsoa11nm, ladnm)
pscdToLsoa = pscdToLsoa %>%
rename(postcode_space = pcds) %>%
rename(lsoa_area = lsoa11nm) %>%
rename(city = ladnm) %>%
select(postcode_space, lsoa_area, city)
View(pscdToLsoa)
colSums(is.na(pscdToLsoa))
bristolBroadbandSpeedCleaned = bristolBroadbandSpeedCleaned %>%
left_join(pscdToLsoa, by = "postcode_space")
View(bristolBroadbandSpeedCleaned)
colnames(bristolBroadbandSpeedCleaned)
dim(bristolBroadbandSpeedCleaned)
cornwallBroadbandSpeedCleaned = cornwallBroadbandSpeedCleaned %>%
left_join(pscdToLsoa, by = "postcode_space")
View(cornwallBroadbandSpeedCleaned)
bcBroadbandSpeedCleaned = bcBroadbandSpeedCleaned %>%
left_join(pscdToLsoa, by = "postcode_space")
bcBroadbandSpeedCleaned
View(bcBroadbandSpeedCleaned)
#Cleaned data sets saved in csv format
write.csv(bristolBroadbandSpeedCleaned, "C:/Users/dell/OneDrive/Desktop/ST5014CEM/Clean data/broadband speed/bristol-broadband-speed.csv", row.names = FALSE)
write.csv(cornwallBroadbandSpeedCleaned, "C:/Users/dell/OneDrive/Desktop/ST5014CEM/Clean data/broadband speed/cornwall-broadband-speed.csv", row.names = FALSE)
write.csv(bcBroadbandSpeedCleaned, "C:/Users/dell/OneDrive/Desktop/ST5014CEM/Clean data/broadband speed/bristol-cornwall-broadband-speed.csv", row.names = FALSE)
library(tidyverse)
library(readr)
library(dplyr)
bsCrimeRate2105 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-05/2021-05-avon-and-somerset-street.csv")
View(bsCrimeRate2105)
dim(bsCrimeRate2105)
colSums(is.na(bsCrimeRate2105))
str(bsCrimeRate2105)
bsCrimeRate2106 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-06/2021-06-avon-and-somerset-street.csv")
dim(bsCrimeRate2106)
colSums(is.na(bsCrimeRate2106))
bsCrimeRate2107 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-07/2021-07-avon-and-somerset-street.csv")
bsCrimeRate2108 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-08/2021-08-avon-and-somerset-street.csv")
bsCrimeRate2109 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-09/2021-09-avon-and-somerset-street.csv")
bsCrimeRate2110 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-10/2021-10-avon-and-somerset-street.csv")
bsCrimeRate2111 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-11/2021-11-avon-and-somerset-street.csv")
bsCrimeRate2112 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-12/2021-12-avon-and-somerset-street.csv")
bsCrimeRate2105 = bsCrimeRate2105 %>%
filter(!is.na(`Crime ID`))
colSums(is.na(bsCrimeRate2105))
dim(bsCrimeRate2105)
bsCrimeRate2106 = bsCrimeRate2106 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2107 = bsCrimeRate2107 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2108 = bsCrimeRate2108 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2109 = bsCrimeRate2109 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2110 = bsCrimeRate2110 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2111 = bsCrimeRate2111 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2112 = bsCrimeRate2112 %>%
filter(!is.na(`Crime ID`))
colSums(is.na(bsCrimeRate2112))
bsCrimeRate2021 = bind_rows(bsCrimeRate2105, bsCrimeRate2106, bsCrimeRate2107, bsCrimeRate2108,
bsCrimeRate2109, bsCrimeRate2110, bsCrimeRate2111, bsCrimeRate2112)
dim(bsCrimeRate2021)
colSums(is.na(bsCrimeRate2021))
bsCrimeRate2021 = bsCrimeRate2021 %>%
select(-Context)
colSums(is.na(bsCrimeRate2021))
summary(bsCrimeRate2021)
sum(duplicated(bsCrimeRate2021))
duplicated_rows = duplicated(bsCrimeRate2021)
bsCrimeRate2021 = bsCrimeRate2021[!duplicated_rows, ]
dim(bsCrimeRate2021)
colSums(is.na(bsCrimeRate2021))
bsCrimeRate2021$Longitude[is.na(bsCrimeRate2021$Longitude)] = median(bsCrimeRate2021$Longitude, na.rm = TRUE)
bsCrimeRate2021$Latitude[is.na(bsCrimeRate2021$Latitude)] = median(bsCrimeRate2021$Latitude, na.rm = TRUE)
colSums(is.na(bsCrimeRate2021))
get_mode = function(v) {
uniqv = unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
lsoaCodeMode = get_mode(bsCrimeRate2021$`LSOA code`[!is.na(bsCrimeRate2021$`LSOA code`)])
lsoaNameMode = get_mode(bsCrimeRate2021$`LSOA name`[!is.na(bsCrimeRate2021$`LSOA name`)])
bsCrimeRate2021$`LSOA code`[is.na(bsCrimeRate2021$`LSOA code`)] = lsoaCodeMode
bsCrimeRate2021$`LSOA name`[is.na(bsCrimeRate2021$`LSOA name`)] = lsoaNameMode
colSums(is.na(bsCrimeRate2021))
summary(bsCrimeRate2021)
sum(duplicated(bsCrimeRate2021))
bsCrimeRate2201 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-01/2022-01-avon-and-somerset-street.csv")
bsCrimeRate2202 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-02/2022-02-avon-and-somerset-street.csv")
bsCrimeRate2203 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-03/2022-03-avon-and-somerset-street.csv")
bsCrimeRate2204 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-04/2022-04-avon-and-somerset-street.csv")
bsCrimeRate2205 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-05/2022-05-avon-and-somerset-street.csv")
bsCrimeRate2206 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-06/2022-06-avon-and-somerset-street.csv")
bsCrimeRate2207 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-07/2022-07-avon-and-somerset-street.csv")
bsCrimeRate2208 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-08/2022-08-avon-and-somerset-street.csv")
bsCrimeRate2209 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-09/2022-09-avon-and-somerset-street.csv")
bsCrimeRate2210 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-10/2022-10-avon-and-somerset-street.csv")
bsCrimeRate2211 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-11/2022-11-avon-and-somerset-street.csv")
bsCrimeRate2212 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-12/2022-12-avon-and-somerset-street.csv")
bsCrimeRate2201 = bsCrimeRate2201 %>%
filter(!is.na(`Crime ID`))
colSums(is.na(bsCrimeRate2201))
bsCrimeRate2202 = bsCrimeRate2202 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2203 = bsCrimeRate2203 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2204 = bsCrimeRate2204 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2205 = bsCrimeRate2205 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2206 = bsCrimeRate2206 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2207 = bsCrimeRate2207 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2208 = bsCrimeRate2208 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2209 = bsCrimeRate2209 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2210 = bsCrimeRate2210 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2211 = bsCrimeRate2211 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2212 = bsCrimeRate2212 %>%
filter(!is.na(`Crime ID`))
colSums(is.na(bsCrimeRate2212))
bsCrimeRate2022 = bind_rows(bsCrimeRate2201, bsCrimeRate2202, bsCrimeRate2203, bsCrimeRate2204,
bsCrimeRate2205, bsCrimeRate2206, bsCrimeRate2207, bsCrimeRate2208,
bsCrimeRate2209, bsCrimeRate2210, bsCrimeRate2211, bsCrimeRate2212)
dim(bsCrimeRate2022)
colSums(is.na(bsCrimeRate2022))
bsCrimeRate2022 = bsCrimeRate2022 %>%
select(-Context)
colSums(is.na(bsCrimeRate2022))
sum(duplicated(bsCrimeRate2022))
duplicated_rows22 = duplicated(bsCrimeRate2022)
bsCrimeRate2022 = bsCrimeRate2022[!duplicated_rows22, ]
dim(bsCrimeRate2022)
colSums(is.na(bsCrimeRate2022))
bsCrimeRate2022$Longitude[is.na(bsCrimeRate2022$Longitude)] = median(bsCrimeRate2022$Longitude, na.rm = TRUE)
bsCrimeRate2022$Latitude[is.na(bsCrimeRate2022$Latitude)] = median(bsCrimeRate2022$Latitude, na.rm = TRUE)
colSums(is.na(bsCrimeRate2022))
lsoaCodeMode22 = get_mode(bsCrimeRate2022$`LSOA code`[!is.na(bsCrimeRate2022$`LSOA code`)])
lsoaNameMode22 = get_mode(bsCrimeRate2022$`LSOA name`[!is.na(bsCrimeRate2022$`LSOA name`)])
bsCrimeRate2022$`LSOA code`[is.na(bsCrimeRate2022$`LSOA code`)] = lsoaCodeMode22
bsCrimeRate2022$`LSOA name`[is.na(bsCrimeRate2022$`LSOA name`)] = lsoaNameMode22
colSums(is.na(bsCrimeRate2022))
summary(bsCrimeRate2022)
sum(duplicated(bsCrimeRate2022))
bsCrimeRate2301 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-01/2023-01-avon-and-somerset-street.csv")
bsCrimeRate2302 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-02/2023-02-avon-and-somerset-street.csv")
bsCrimeRate2303 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-03/2023-03-avon-and-somerset-street.csv")
bsCrimeRate2304 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-04/2023-04-avon-and-somerset-street.csv")
bsCrimeRate2305 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-05/2023-05-avon-and-somerset-street.csv")
bsCrimeRate2306 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-06/2023-06-avon-and-somerset-street.csv")
bsCrimeRate2307 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-07/2023-07-avon-and-somerset-street.csv")
bsCrimeRate2308 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-08/2023-08-avon-and-somerset-street.csv")
bsCrimeRate2309 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-09/2023-09-avon-and-somerset-street.csv")
bsCrimeRate2310 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-10/2023-10-avon-and-somerset-street.csv")
bsCrimeRate2311 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-11/2023-11-avon-and-somerset-street.csv")
bsCrimeRate2312 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-12/2023-12-avon-and-somerset-street.csv")
bsCrimeRate2301 = bsCrimeRate2301 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2302 = bsCrimeRate2302 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2303 = bsCrimeRate2303 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2304 = bsCrimeRate2304 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2305 = bsCrimeRate2305 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2306 = bsCrimeRate2306 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2307 = bsCrimeRate2307 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2308 = bsCrimeRate2308 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2309 = bsCrimeRate2309 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2310 = bsCrimeRate2310 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2311 = bsCrimeRate2311 %>%
filter(!is.na(`Crime ID`))
bsCrimeRate2312 = bsCrimeRate2312 %>%
filter(!is.na(`Crime ID`))
colSums(is.na(bsCrimeRate2312))
bsCrimeRate2023 = bind_rows(bsCrimeRate2301, bsCrimeRate2302, bsCrimeRate2303, bsCrimeRate2304,
bsCrimeRate2305, bsCrimeRate2306, bsCrimeRate2307, bsCrimeRate2308,
bsCrimeRate2309, bsCrimeRate2310, bsCrimeRate2311, bsCrimeRate2312)
dim(bsCrimeRate2023)
colSums(is.na(bsCrimeRate2023))
bsCrimeRate2023 = bsCrimeRate2023 %>%
select(-Context)
colSums(is.na(bsCrimeRate2023))
sum(duplicated(bsCrimeRate2023))
duplicated_rows23 = duplicated(bsCrimeRate2023)
bsCrimeRate2023 = bsCrimeRate2023[!duplicated_rows23, ]
dim(bsCrimeRate2023)
colSums(is.na(bsCrimeRate2023))
summary(bsCrimeRate2023)
bsCrimeRate2023$Longitude[is.na(bsCrimeRate2023$Longitude)] = median(bsCrimeRate2023$Longitude, na.rm = TRUE)
bsCrimeRate2023$Latitude[is.na(bsCrimeRate2023$Latitude)] = median(bsCrimeRate2023$Latitude, na.rm = TRUE)
colSums(is.na(bsCrimeRate2023))
lsoaCodeMode23 = get_mode(bsCrimeRate2023$`LSOA code`[!is.na(bsCrimeRate2023$`LSOA code`)])
lsoaNameMode23 = get_mode(bsCrimeRate2023$`LSOA name`[!is.na(bsCrimeRate2023$`LSOA name`)])
bsCrimeRate2023$`LSOA code`[is.na(bsCrimeRate2023$`LSOA code`)] = lsoaCodeMode23
bsCrimeRate2023$`LSOA name`[is.na(bsCrimeRate2023$`LSOA name`)] = lsoaNameMode23
colSums(is.na(bsCrimeRate2023))
summary(bsCrimeRate2023)
sum(duplicated(bsCrimeRate2023))
cwCrimeRate2105 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-05/2021-05-devon-and-cornwall-street.csv")
cwCrimeRate2106 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-06/2021-06-devon-and-cornwall-street.csv")
cwCrimeRate2107 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-07/2021-07-devon-and-cornwall-street.csv")
cwCrimeRate2108 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-08/2021-08-devon-and-cornwall-street.csv")
cwCrimeRate2109 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-09/2021-09-devon-and-cornwall-street.csv")
cwCrimeRate2110 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-10/2021-10-devon-and-cornwall-street.csv")
cwCrimeRate2111 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-11/2021-11-devon-and-cornwall-street.csv")
cwCrimeRate2112 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2021-12/2021-12-devon-and-cornwall-street.csv")
cwCrimeRate2105 = cwCrimeRate2105 %>%
filter(!is.na(`Crime ID`))
colSums(is.na(cwCrimeRate2105))
cwCrimeRate2106 = cwCrimeRate2106 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2107 = cwCrimeRate2107 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2108 = cwCrimeRate2108 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2109 = cwCrimeRate2109 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2110 = cwCrimeRate2110 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2111 = cwCrimeRate2111 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2112 = cwCrimeRate2112 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2021 = bind_rows(cwCrimeRate2105, cwCrimeRate2106, cwCrimeRate2107, cwCrimeRate2108,
cwCrimeRate2109, cwCrimeRate2110, cwCrimeRate2111, cwCrimeRate2112)
colSums(is.na(cwCrimeRate2021))
cwCrimeRate2021 = cwCrimeRate2021 %>%
select(-Context)
colSums(is.na(cwCrimeRate2021))
sum(duplicated(cwCrimeRate2021))
duplicated_rows_cw21 = duplicated(cwCrimeRate2021)
cwCrimeRate2021 = cwCrimeRate2021[!duplicated_rows_cw21, ]
dim(cwCrimeRate2021)
colSums(is.na(cwCrimeRate2021))
cwCrimeRate2021$Longitude[is.na(cwCrimeRate2021$Longitude)] = median(cwCrimeRate2021$Longitude, na.rm = TRUE)
cwCrimeRate2021$Latitude[is.na(cwCrimeRate2021$Latitude)] = median(cwCrimeRate2021$Latitude, na.rm = TRUE)
colSums(is.na(cwCrimeRate2021))
lsoaCodeMode_cw21 = get_mode(cwCrimeRate2021$`LSOA code`[!is.na(cwCrimeRate2021$`LSOA code`)])
lsoaNameMode_cw21 = get_mode(cwCrimeRate2021$`LSOA name`[!is.na(cwCrimeRate2021$`LSOA name`)])
cwCrimeRate2021$`LSOA code`[is.na(cwCrimeRate2021$`LSOA code`)] = lsoaCodeMode_cw21
cwCrimeRate2021$`LSOA name`[is.na(cwCrimeRate2021$`LSOA name`)] = lsoaNameMode_cw21
colSums(is.na(cwCrimeRate2021))
summary(cwCrimeRate2021)
sum(duplicated(cwCrimeRate2021))
cwCrimeRate2201 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-01/2022-01-devon-and-cornwall-street.csv")
cwCrimeRate2202 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-02/2022-02-devon-and-cornwall-street.csv")
cwCrimeRate2203 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-03/2022-03-devon-and-cornwall-street.csv")
cwCrimeRate2204 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-04/2022-04-devon-and-cornwall-street.csv")
cwCrimeRate2205 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-05/2022-05-devon-and-cornwall-street.csv")
cwCrimeRate2206 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-06/2022-06-devon-and-cornwall-street.csv")
cwCrimeRate2207 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-07/2022-07-devon-and-cornwall-street.csv")
cwCrimeRate2208 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-08/2022-08-devon-and-cornwall-street.csv")
cwCrimeRate2209 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-09/2022-09-devon-and-cornwall-street.csv")
cwCrimeRate2210 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-10/2022-10-devon-and-cornwall-street.csv")
cwCrimeRate2211 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-11/2022-11-devon-and-cornwall-street.csv")
cwCrimeRate2212 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2022-12/2022-12-devon-and-cornwall-street.csv")
cwCrimeRate2201 = cwCrimeRate2201 %>%
filter(!is.na(`Crime ID`))
colSums(is.na(cwCrimeRate2201))
cwCrimeRate2202 = cwCrimeRate2202 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2203 = cwCrimeRate2203 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2204 = cwCrimeRate2204 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2205 = cwCrimeRate2205 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2206 = cwCrimeRate2206 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2207 = cwCrimeRate2207 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2208 = cwCrimeRate2208 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2209 = cwCrimeRate2209 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2210 = cwCrimeRate2210 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2211 = cwCrimeRate2211 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2212 = cwCrimeRate2212 %>%
filter(!is.na(`Crime ID`))
colSums(is.na(cwCrimeRate2212))
cwCrimeRate2022 = bind_rows(cwCrimeRate2201, cwCrimeRate2202, cwCrimeRate2203, cwCrimeRate2204,
cwCrimeRate2205, cwCrimeRate2206, cwCrimeRate2207, cwCrimeRate2208,
cwCrimeRate2209, cwCrimeRate2210, cwCrimeRate2211, cwCrimeRate2212)
dim(cwCrimeRate2022)
View(cwCrimeRate2022)
cwCrimeRate2022 = cwCrimeRate2022 %>%
select(-Context)
colSums(is.na(cwCrimeRate2022))
sum(duplicated(cwCrimeRate2022))
duplicated_rows_cw22 = duplicated(cwCrimeRate2022)
cwCrimeRate2022 = cwCrimeRate2022[!duplicated_rows_cw22, ]
dim(cwCrimeRate2022)
colSums(is.na(cwCrimeRate2022))
cwCrimeRate2022$Longitude[is.na(cwCrimeRate2022$Longitude)] = median(cwCrimeRate2022$Longitude, na.rm = TRUE)
cwCrimeRate2022$Latitude[is.na(cwCrimeRate2022$Latitude)] = median(cwCrimeRate2022$Latitude, na.rm = TRUE)
colSums(is.na(cwCrimeRate2022))
lsoaCodeMode_cw22 = get_mode(cwCrimeRate2022$`LSOA code`[!is.na(cwCrimeRate2022$`LSOA code`)])
lsoaNameMode_cw22 = get_mode(cwCrimeRate2022$`LSOA name`[!is.na(cwCrimeRate2022$`LSOA name`)])
cwCrimeRate2022$`LSOA code`[is.na(cwCrimeRate2022$`LSOA code`)] = lsoaCodeMode_cw22
cwCrimeRate2022$`LSOA name`[is.na(cwCrimeRate2022$`LSOA name`)] = lsoaNameMode_cw22
colSums(is.na(cwCrimeRate2022))
summary(cwCrimeRate2022)
sum(duplicated(cwCrimeRate2022))
cwCrimeRate2301 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-01/2023-01-devon-and-cornwall-street.csv")
cwCrimeRate2302 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-02/2023-02-devon-and-cornwall-street.csv")
cwCrimeRate2303 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-03/2023-03-devon-and-cornwall-street.csv")
cwCrimeRate2304 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-04/2023-04-devon-and-cornwall-street.csv")
cwCrimeRate2305 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-05/2023-05-devon-and-cornwall-street.csv")
cwCrimeRate2306 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-06/2023-06-devon-and-cornwall-street.csv")
cwCrimeRate2307 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-07/2023-07-devon-and-cornwall-street.csv")
cwCrimeRate2308 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-08/2023-08-devon-and-cornwall-street.csv")
cwCrimeRate2309 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-09/2023-09-devon-and-cornwall-street.csv")
cwCrimeRate2310 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-10/2023-10-devon-and-cornwall-street.csv")
cwCrimeRate2311 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-11/2023-11-devon-and-cornwall-street.csv")
cwCrimeRate2312 = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/crime rate/2023-12/2023-12-devon-and-cornwall-street.csv")
cwCrimeRate2301 = cwCrimeRate2301 %>%
filter(!is.na(`Crime ID`))
colSums(is.na(cwCrimeRate2301))
cwCrimeRate2302 = cwCrimeRate2302 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2303 = cwCrimeRate2303 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2304 = cwCrimeRate2304 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2305 = cwCrimeRate2305 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2306 = cwCrimeRate2306 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2307 = cwCrimeRate2307 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2308 = cwCrimeRate2308 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2309 = cwCrimeRate2309 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2310 = cwCrimeRate2310 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2311 = cwCrimeRate2311 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2312 = cwCrimeRate2312 %>%
filter(!is.na(`Crime ID`))
cwCrimeRate2023 = bind_rows(cwCrimeRate2301, cwCrimeRate2302, cwCrimeRate2303, cwCrimeRate2304,
cwCrimeRate2305, cwCrimeRate2306, cwCrimeRate2307, cwCrimeRate2308,
cwCrimeRate2309, cwCrimeRate2310, cwCrimeRate2311, cwCrimeRate2312)
dim(cwCrimeRate2023)
cwCrimeRate2023 = cwCrimeRate2023 %>%
select(-Context)
colSums(is.na(cwCrimeRate2023))
sum(duplicated(cwCrimeRate2023))
cwCrimeRate2023$Longitude[is.na(cwCrimeRate2023$Longitude)] = median(cwCrimeRate2023$Longitude, na.rm = TRUE)
cwCrimeRate2023$Latitude[is.na(cwCrimeRate2023$Latitude)] = median(cwCrimeRate2023$Latitude, na.rm = TRUE)
colSums(is.na(cwCrimeRate2023))
lsoaCodeMode_cw23 = get_mode(cwCrimeRate2023$`LSOA code`[!is.na(cwCrimeRate2023$`LSOA code`)])
lsoaNameMode_cw23 = get_mode(cwCrimeRate2023$`LSOA name`[!is.na(cwCrimeRate2023$`LSOA name`)])
cwCrimeRate2023$`LSOA code`[is.na(cwCrimeRate2023$`LSOA code`)] = lsoaCodeMode_cw23
cwCrimeRate2023$`LSOA name`[is.na(cwCrimeRate2023$`LSOA name`)] = lsoaNameMode_cw23
colSums(is.na(cwCrimeRate2023))
summary(cwCrimeRate2023)
bristolCrimeRateCleaned = bind_rows(bsCrimeRate2021, bsCrimeRate2022, bsCrimeRate2023)
View(bristolCrimeRateCleaned)
cornwallCrimeRateCleaned = bind_rows(cwCrimeRate2021, cwCrimeRate2022, cwCrimeRate2023)
#For adding town/city to the data set
pscdToLsoa = read_csv("C:/Users/dell/OneDrive/Desktop/ST5014CEM/Datasets/population/Postcode to LSOA.csv")
View(pscdToLsoa)
pscdToLsoa = pscdToLsoa %>%
rename(postcode_space = pcds) %>%
rename(`LSOA code` = lsoa11cd) %>%
rename(city = ladnm) %>%
select(postcode_space, `LSOA code`, city)
View(pscdToLsoa)
View(cornwallCrimeRateCleaned)
bristolCrimeRateCleaned = bristolCrimeRateCleaned %>%
rename(Year = Month) %>%
select(`Crime ID`, Year, `LSOA code`, `LSOA name`, `Crime type`) %>%
left_join(pscdToLsoa, by = "LSOA code")
library(tidyverse)
library(readr)
library(dplyr)
bristolCrimeRateCleaned = bristolCrimeRateCleaned %>%
rename(Year = Month) %>%
select(`Crime ID`, Year, `LSOA code`, `LSOA name`, `Crime type`) %>%
left_join(pscdToLsoa, by = "LSOA code")
View(bristolCrimeRateCleaned)
dim(bristolCrimeRateCleaned)
library(tidyverse)
library(readr)
library(dplyr)
dim(bristolCrimeRateCleaned)
sum(duplicated(bristolCrimeRateCleaned))
dim(pscdToLsoa)
pscdToLsoa = pscdToLsoa %>%
group_by(`LSOA code`) %>%
summarize(
postcode_space = first(postcode_space),
city = first(city))
dim(pscdToLsoa)
View(pscdToLsoa)
pscdToLsoa %>%
filter(city == "Bristol")
pscdToLsoa %>%
filter(city == "Bristol, City of")
pscdToLsoa %>%
filter(city == "Cornwall")
bristolCrimeRateCleaned = bristolCrimeRateCleaned %>%
rename(Year = Month) %>%
select(`Crime ID`, Year, `LSOA code`, `LSOA name`, `Crime type`) %>%
inner_join(pscdToLsoa, by = "LSOA code")
View(bristolCrimeRateCleaned)
dim(bristolCrimeRateCleaned)
bristolCrimeRateCleaned = bristolCrimeRateCleaned %>%
group_by(`LSOA code`, `Crime type`) %>%
mutate(CrimeTypeCount = n()) %>%
ungroup()
View(bristolCrimeRateCleaned)
bristolCrimeRateCleaned = bristolCrimeRateCleaned %>%
select(-CrimeTypeCount)
View(bristolCrimeRateCleaned)
dim(bristolCrimeRateCleaned)
bristolCrimeSummary = bristolCrimeRateCleaned %>%
group_by(postcode_space, Year, `Crime type`) %>%
summarize(CrimeTypeCount = n(), .groups = 'drop')
View(bri)
View(bristolCrimeSummary)
bristolCrimeSummary = bristolCrimeRateCleaned %>%
group_by(postcode_space, `LSOA name`, Year, `Crime type`) %>%
summarize(CrimeTypeCount = n(), .groups = 'drop')
View(bristolCrimeSummary)
bristolCrimeSummary = bristolCrimeRateCleaned %>%
group_by(postcode_space, `LSOA name`, Year, `Crime type`) %>%
summarize(CrimeTypeCount = n(), .groups = 'drop') %>%
arrange(Year)
View(bristolCrimeSummary)
cornwallCrimeRateCleaned = cornwallCrimeRateCleaned %>%
rename(Year = Month) %>%
select(`Crime ID`, Year, `LSOA code`, `LSOA name`, `Crime type`) %>%
inner_join(pscdToLsoa, by = "LSOA code")
View(cornwallCrimeRateCleaned)
dim(cornwallCrimeRateCleaned)
View(bristolCrimeSummary)
cornwallCrimeSummary = cornwallCrimeRateCleaned %>%
group_by(postcode_space, `LSOA name`, Year, `Crime type`) %>%
summarize(CrimeTypeCount = n(), .groups = 'drop') %>%
arrange(Year)
View(cornwallCrimeSummary)
bristolCrimeSummary = bristolCrimeRateCleaned %>%
group_by(postcode_space, `city`, Year, `Crime type`) %>%
summarize(CrimeTypeCount = n(), .groups = 'drop') %>%
arrange(Year)
View(bristolCrimeSummary)
bristolCrimeSummary = bristolCrimeRateCleaned %>%
group_by(`city`, Year, `Crime type`) %>%
summarize(CrimeTypeCount = n(), .groups = 'drop') %>%
arrange(Year)
View(bristolCrimeSummary)
cornwallCrimeSummary = cornwallCrimeRateCleaned %>%
group_by(city, Year, `Crime type`) %>%
summarize(CrimeTypeCount = n(), .groups = 'drop') %>%
arrange(Year)
View(cornwallCrimeSummary)
write.csv(bristolCrimeRateCleaned, "C:/Users/dell/OneDrive/Desktop/ST5014CEM/Clean data/crime rate/bristol-crime-rate.csv", row.names = FALSE)
write.csv(cornwallCrimeRateCleaned, "C:/Users/dell/OneDrive/Desktop/ST5014CEM/Clean data/crime rate/cornwall-crime-rate.csv", row.names = FALSE)
write.csv(bristolCrimeSummary, "C:/Users/dell/OneDrive/Desktop/ST5014CEM/Clean data/crime rate/bristol-crime-summary.csv", row.names = FALSE)
write.csv(cornwallCrimeSummary, "C:/Users/dell/OneDrive/Desktop/ST5014CEM/Clean data/crime rate/cornwall-crime-summary.csv", row.names = FALSE)
