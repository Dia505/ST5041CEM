theme(plot.title = element_text(size = 11))
#FOR SCHOOLS IN CORNWALL COUNTY
cw_att8scr_downloadSpeed_2022 = inner_join(
cornwallSchools2022, cornwallBroadbandSpeed,
by = c("POSTCODE" = "postcode_space")) %>%
select(ATT8SCR, `Average download speed (Mbit/s)`)
View(cw_att8scr_downloadSpeed_2022)
#Weak negative relationship (-0.284)
cw_att8scr_downloadSpeed_2022 %>%
summarise(corCoeff = cor(ATT8SCR, `Average download speed (Mbit/s)`))
View(cw_att8scr_downloadSpeed_2022)
#Weak negative relationship (-0.284)
cw_att8scr_downloadSpeed_2022 %>%
summarise(corCoeff = cor(ATT8SCR, `Average download speed (Mbit/s)`))
cwModel_att8scr_downloadSpeed = lm(ATT8SCR ~ `Average download speed (Mbit/s)`, data = cw_att8scr_downloadSpeed_2022)
summary(cwModel_att8scr_downloadSpeed)
cwIntercept_att8scr_downloadSpeed = coef(cwModel_att8scr_downloadSpeed)[1]
cwSlope_att8scr_downloadSpeed = coef(cwModel_att8scr_downloadSpeed)[2]
ggplot(cw_att8scr_downloadSpeed_2022, aes(x = `Average download speed (Mbit/s)`, y = ATT8SCR)) +
geom_point(color = "blue", size = 2) +
geom_abline(intercept = cwIntercept_att8scr_downloadSpeed, slope = cwSlope_att8scr_downloadSpeed, color = "red") +
labs(
title = "Impact of Average Download Speed on Attainment 8 Score in Cornwall Schools (2022)",
x = "Average Download Speed",
y = "Attainment 8 Score"
) +
theme_minimal() +
theme(plot.title = element_text(size = 11))
library(tidyverse)
View(bristolSchools2022)
colSums(is.na(bristolSchools2022))
View(bs_drugOffenceRate_2022)
View(cw_drugOffenceRate_2022)
View(bristolSchools2022)
View(bs_housePrice_att8scr_2022)
View(bs_housePrice_att8scr_2022)
View(bs_housePrice_att8scr_2022)
radar_data = vehicleCrimeRateSummary %>%
pivot_wider(names_from = `LSOA name`, values_from = vehicleCrimeRate_per_10000, values_fill = list(vehicleCrimeRate_per_10000 = 0)) %>%
select(-city) %>%
as.data.frame()
max_values = rep(max(radar_data[-1], na.rm = TRUE), ncol(radar_data))
radar_data = rbind(rep(0, ncol(radar_data)), max_values, radar_data)
max_values = rep(max(radar_data[-1], na.rm = TRUE), ncol(radar_data))
radar_data = rbind(rep(0, ncol(radar_data)), max_values, radar_data)
#Set up the radar chart
colnames(radar_data) = c("Bristol", "Cornwall")
radarchart(radar_data,
axistype = 1,
pcol = c("blue", "red"),
pfcol = c("blue", "red"),
plwd = 2,
cglcol = "grey",
cglty = 1,
axislabcol = "grey",
vlcex = 0.8,
title = "Vehicle Crime Rate per 10,000 People in Bristol and Cornwall (Nov 2022)",
cex.main = 1)
library(fmsb)
radarchart(radar_data,
axistype = 1,
pcol = c("blue", "red"),
pfcol = c("blue", "red"),
plwd = 2,
cglcol = "grey",
cglty = 1,
axislabcol = "grey",
vlcex = 0.8,
title = "Vehicle Crime Rate per 10,000 People in Bristol and Cornwall (Nov 2022)",
cex.main = 1)
#Set up the radar chart
colnames(radar_data) = c("Max","Bristol", "Cornwall")
radarchart(radar_data,
axistype = 1,
pcol = c("blue", "red"),
pfcol = c("blue", "red"),
plwd = 2,
cglcol = "grey",
cglty = 1,
axislabcol = "grey",
vlcex = 0.8,
title = "Vehicle Crime Rate per 10,000 People in Bristol and Cornwall (Nov 2022)",
cex.main = 1)
#Set up the radar chart
colnames(radar_data) = c("Max",'Min',"Bristol", "Cornwall")
#Plot radar chart
radarchart(radar_data,
axistype = 1,
pcol = c("blue", "red"),
pfcol = c("blue", "red"),
plwd = 2,
cglcol = "grey",
cglty = 1,
axislabcol = "grey",
vlcex = 0.8,
title = "Vehicle Crime Rate per 10,000 People in Bristol and Cornwall (Nov 2022)",
cex.main = 1)
#LINEAR MODELLING
#FOR BRISTOL
bs_att8scr_drugRate_2022 = inner_join(bristolSchools2022, bs_drugOffenceRate_2022,
by = c("POSTCODE" = "postcode_space")) %>%
select(ATT8SCR, drug_offense_rate)
bs_att8scr_drugRate_2022 = inner_join(bristolSchools2022, bs_drugOffenceRate_2022,
by = c("POSTCODE" = "postcode_space")) %>%
select(ATT8SCR, drug_offense_rate)
View(bs_att8scr_drugRate_2022)
#LINEAR MODELLING
#FOR BRISTOL
bs_att8scr_drugRate_2022 = inner_join(
bristolSchools2022, bs_drugOffenceRate_2022,
by = c("POSTCODE" = "postcode_space")) %>%
select(ATT8SCR, drug_offense_rate)
View(bs_att8scr_drugRate_2022)
View(bs_drugOffenceRate_2022)
bristolSchools2022 = bristolSchools %>%
filter(Year == 2022 & ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR))
View(bristolSchools2022)
View(bristolSchools)
bristolSchools_2022_2023 = bristolSchools %>%
filter(Year == 2022 | Year == 2023 & ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR))
View(bristolSchools_2022_2023)
bristolSchools_2022_2023 = bristolSchools %>%
filter(Year == 2022 | Year == 2023)
View(bristolSchools_2022_2023)
colSums(is.na(bristolSchools_2022_2023))
bristolSchools_2022_2023 = bristolSchools_2022_2023 %>%
filter(ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR))
View(bristolSchools_2022_2023)
colSums(is.na(bristolSchools_2022_2023))
cornwallSchools_2022_2023 = cornwallSchools %>%
filter(Year == 2022 | Year == 2023)
View(cornwallSchools_2022_2023)
colSums(is.na(cornwallSchools_2022_2023))
cornwallSchools_2022_2023 = cornwallSchools_2022_2023 %>%
filter(ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR))
View(cornwallSchools_2022_2023)
View(population_2023)
bs_drugOffenceRate_2022 = bristolCrimeRate %>%
filter(year(Year) == 2022) %>%
left_join(population_2022, by = "Postcode") %>%
rename("population_2022" = "population") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of")
View(population_2022)
bs_drugOffenceRate_2022 = bristolCrimeRate %>%
filter(year(Year) == 2022) %>%
left_join(population_2022, by = "Postcode") %>%
rename("population_2022" = "Population") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of")
View(bs_drugOffenceRate_2022)
colSums(is.na(bs_drugOffenceRate_2022))
bs_drugOffenceRate_2022_2023 = bristolCrimeRate %>%
filter(year(Year) == 2022 | year(Year) == 2023) %>%
left_join(population_2022, by = "Postcode") %>%
rename("population_2022" = "Population") %>%
left_join(population_2023, by = "Postcode") %>%
rename("population_2023" = "Population") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of")
View(bs_drugOffenceRate_2022)
bs_drugOffenceRate_2022 = bristolCrimeRate %>%
filter(year(Year) == 2022 | year(Year) == 2023) %>%
left_join(population_2022, by = "Postcode") %>%
rename("population_2022" = "Population") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of")
View(bs_drugOffenceRate_2022)
colSums(is.na(bs_drugOffenceRate_2022))
bs_drugOffenceRate_2022 = bristolCrimeRate %>%
filter(year(Year) == 2022) %>%
left_join(population_2022, by = "Postcode") %>%
rename("population_2022" = "Population") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of")
View(bs_drugOffenceRate_2022)
colSums(is.na(bs_drugOffenceRate_2022))
bs_drugOffenceRate_2022 = bristolCrimeRate %>%
filter(year(Year) == 2022) %>%
left_join(population_2022, by = "Postcode") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of")
View(bs_drugOffenceRate_2022)
#bs_drugOffenceRate_2022 is refined by removing rows with NA population
bs_drugOffenceRate_2022 = bs_drugOffenceRate_2022 %>%
filter(!is.na(Population)) %>%
group_by(postcode_space) %>%
summarise(drug_offenses = n(),
population = first(Population)) %>%
mutate(drug_offense_rate = drug_offenses / population * 10000)
View(bs_drugOffenceRate_2022)
bs_drugOffenceRate_2022 = bristolCrimeRate %>%
filter(year(Year) == 2022) %>%
left_join(population_2022, by = "Postcode") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of")
bs_drugOffenceRate_2023 = bristolCrimeRate %>%
filter(year(Year) == 2023) %>%
left_join(population_2023, by = "Postcode") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of")
View(bs_drugOffenceRate_2023)
colSums(is.na(bs_drugOffenceRate_2023))
bs_drugOffenceRate_2022_2023 = bind_rows(bs_drugOffenceRate_2022, bs_drugOffenceRate_2023)
View(bs_drugOffenceRate_2022_2023)
colSums(is.na(bs_drugOffenceRate_2022_2023))
dim(bs_drugOffenceRate_2022_2023)
sum(duplicated(bs_drugOffenceRate_2022_2023))
bs_drugOffenceRate_2022_2023 %>%
group_by(postcode_space)
View(bs_drugOffenceRate_2022_2023 %>%
group_by(postcode_space))
View(population_2022)
population_2022_2023 = left_join(population_2022, population_2023, by = "Postcode") %>%
rename(population_2022 = Population.x, population_2023 = Population.y) %>%
mutate(avg_population = (population_2022 + population_2023) / 2)
View(population_2022_2023)
colSums(is.na(population_2022_2023))
bs_drugOffenceRate_2022_2023 = bristolCrimeRate %>%
filter(year(Year) %in% c(2022, 2023)) %>%
left_join(population_2022_2023, by = "Postcode") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of") %>%
group_by(Postcode) %>%
summarise(drug_offences = n(), avg_population = first(avg_population)) %>%
mutate(drug_offence_rate = drug_offences / avg_population * 10000)
View(bs_drugOffenceRate_2022)
View(bs_drugOffenceRate_2022_2023)
dim(bs_drugOffenceRate_2022_2023)
bs_drugOffenceRate_2022_2023 = bristolCrimeRate %>%
filter(year(Year) %in% c(2022, 2023)) %>%
left_join(population_2022_2023, by = "Postcode") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of")
View(bs_drugOffenceRate_2022_2023)
dim(bs_drugOffenceRate_2022_2023)
colSums(is.na(bs_drugOffenceRate_2022_2023))
bs_drugOffenceRate_2022_2023 = bristolCrimeRate %>%
filter(year(Year) %in% c(2022, 2023)) %>%
left_join(population_2022_2023, by = "Postcode") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of") %>%
group_by(postcode_space) %>%
summarise(drug_offences = n(), avg_population = first(avg_population)) %>%
mutate(drug_offence_rate = drug_offences / avg_population * 10000)
View(bs_drugOffenceRate_2022_2023)
dim(bs_drugOffenceRate_2022_2023)
colSums(is.na(bs_drugOffenceRate_2022_2023))
bs_drugOffenceRate_2022_2023 = bs_drugOffenceRate_2022_2023 %>%
filter(!is.na(avg_population))
colSums(is.na(bs_drugOffenceRate_2022_2023))
View(bs_drugOffenceRate_2022_2023)
cw_drugOffenceRate_2022_2023 = cornwallCrimeRate %>%
filter(year(Year) %in% c(2022, 2023)) %>%
left_join(population_2022_2023, by = "Postcode") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Cornwall") %>%
group_by(postcode_space) %>%
summarise(drug_offences = n(), avg_population = first(avg_population)) %>%
mutate(drug_offence_rate = drug_offences / avg_population * 10000)
View(cw_drugOffenceRate_2022_2023)
dim(cw_drugOffenceRate_2022_2023)
colSums(is.na(cw_drugOffenceRate_2022_2023))
cw_drugOffenceRate_2022_2023 = cw_drugOffenceRate_2022_2023 %>%
filter(!is.na(avg_population))
dim(cw_drugOffenceRate_2022_2023)
colSums(is.na(cw_drugOffenceRate_2022_2023))
#LINEAR MODELLING
#FOR BRISTOL
bs_att8scr_drugRate_2022_2023 = inner_join(
bristolSchools_2022_2023, bs_drugOffenceRate_2022_2023,
by = c("POSTCODE" = "postcode_space")) %>%
select(ATT8SCR, drug_offence_rate)
View(bs_att8scr_drugRate_2022_2023)
bristolSchools_2022_2023 = bristolSchools_2022_2023 %>%
filter(ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR))
View(bristolSchools_2022_2023)
bristolSchools_2022_2023 = bristolSchools %>%
filter(Year == 2022 | Year == 2023)
colSums(is.na(bristolSchools_2022_2023))
View(bristolSchools_2022_2023)
bristolSchools_2022_2023 = bristolSchools_2022_2023 %>%
filter(ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR))
View(bristolSchools_2022_2023)
View(bs_att8scr_drugRate_2022_2023)
common_postcodes = intersect(bristolSchools_2022_2023$POSTCODE, bs_drugOffenceRate_2022_2023$postcode_space)
length(common_postcodes)
head(bs_drugOffenceRate_2022_2023)
head(bristolSchools_2022_2023)
bs_drugOffenceRate_2022_2023 = bristolCrimeRate %>%
filter(year(Year) %in% c(2022, 2023)) %>%
left_join(population_2022_2023, by = "Postcode") %>%
filter(`Crime type` == "Drugs") %>%
filter(city == "Bristol, City of") %>%
group_by(postcode_space) %>%
summarise(drug_offences = n(), avg_population = first(avg_population)) %>%
mutate(drug_offence_rate = drug_offences / avg_population * 10000)
common_postcodes = intersect(bristolSchools_2022_2023$POSTCODE, bs_drugOffenceRate_2022_2023$postcode_space)
length(common_postcodes)
#LINEAR MODELLING
#FOR BRISTOL
bs_att8scr_drugRate_2022_2023 = inner_join(
bristolSchools_2022_2023, bs_drugOffenceRate_2022_2023,
by = c("POSTCODE" = "postcode_space")) %>%
select(ATT8SCR, drug_offence_rate)
View(bs_att8scr_drugRate_2022_2023)
bs_drugOffenceRate_2022_2023 = bs_drugOffenceRate_2022_2023 %>%
filter(!is.na(avg_population))
colSums(is.na(bs_drugOffenceRate_2022_2023))
dim(bs_drugOffenceRate_2022_2023)
cw_att8scr_drugRate_2022_2023 = inner_join(
cornwallSchools_2022_2023, cw_drugOffenceRate_2022_2023,
by = c("POSTCODE" = "postcode_space")) %>%
cw_att8scr_drugRate_2022_2023 = inner_join(
cornwallSchools_2022_2023, cw_drugOffenceRate_2022_2023,
by = c("POSTCODE" = "postcode_space"))
cw_att8scr_drugRate_2022_2023 = inner_join(
cornwallSchools_2022_2023, cw_drugOffenceRate_2022_2023,
by = c("POSTCODE" = "postcode_space"))
View(cw_att8scr_drugRate_2022_2023)
View(cw_drugOffenceRate_2022_2023)
View(cornwallSchools_2022_2023)
View(cornwallSchools_2022_2023 %>%
arrange(POSTCODE))
View(cw_att8scr_drugRate_2022_2023)
View(bs_drugOffenceRate_2022)
View(bristolSchools)
View(bristolHousePrice)
bristolHousePrice_2022_2023 = bristolHousePrice %>%
filter(year(Date_of_transfer) == 2022 | year(Date_of_transfer) == 2023)
View(bristolHousePrice2022)
View(bristolHousePrice_2022_2023)
cornwallHousePrice2022_2023 = cornwallHousePrice %>%
filter(year(Date_of_transfer) == 2022 | year(Date_of_transfer) == 2023)
cornwallHousePrice_2022_2023 = cornwallHousePrice %>%
filter(year(Date_of_transfer) == 2022 | year(Date_of_transfer) == 2023)
View(cornwallHousePrice_2022_2023)
bristolSchools_2022_2023 = bristolSchools %>%
filter(Year == 2022 | Year == 2023) %>%
filter(ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR))
View(bristolSchools_2022_2023)
cornwallSchools_2022_2023 = cornwallSchools %>%
filter(Year == 2022 | Year == 2023) %>%
filter(ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR))
View(cornwallSchools_2022_2023)
View(bs_housePrice_att8scr_2022)
bs_housePrice_att8scr_2022_2023 = inner_join(bristolHousePrice_2022_2023, bristolSchools_2022_2023, by = c("Postcode" = "POSTCODE")) %>%
select(Price, ATT8SCR)
View(bs_housePrice_att8scr_2022_2023)
bs_housePrice_att8scr_2022_2023 = inner_join(bristolHousePrice_2022_2023, bristolSchools_2022_2023,
by = c("Postcode" = "POSTCODE"))
View(bs_housePrice_att8scr_2022_2023)
# Check for duplicates in bristolHousePrice_2022_2023
bristolHousePrice_duplicates = bristolHousePrice_2022_2023 %>%
group_by(Postcode) %>%
filter(n() > 1)
# Check for duplicates in bristolSchools_2022_2023
bristolSchools_duplicates = bristolSchools_2022_2023 %>%
group_by(POSTCODE) %>%
filter(n() > 1)
# View duplicates
print(bristolHousePrice_duplicates)
print(bristolSchools_duplicates)
bs_housePrice_att8scr_2022_2023 = inner_join(bristolHousePrice_2022_2023, bristolSchools_2022_2023,
by = c("Postcode" = "POSTCODE"))
bs_housePrice_att8scr_2022_2023
sum(duplicated(bs_housePrice_att8scr_2022_2023))
bs_housePrice_att8scr_2022_2023 = inner_join(bristolHousePrice_2022_2023, bristolSchools_2022_2023,
by = c("Postcode" = "POSTCODE")) %>%
select(Price, ATT8SCR)
View(bs_housePrice_att8scr_2022_2023)
bristolHousePrice_2022_2023 = bristolHousePrice %>%
filter(year(Date_of_transfer) == 2022 | year(Date_of_transfer) == 2023) %>%
group_by(Postcode) %>%
summarise(Avg_Price = mean(Price, na.rm = TRUE), .groups = 'drop')
View(bristolHousePrice_2022_2023)
cornwallHousePrice_2022_2023 = cornwallHousePrice %>%
filter(year(Date_of_transfer) == 2022 | year(Date_of_transfer) == 2023) %>%
group_by(Postcode) %>%
summarise(Avg_Price = mean(Price, na.rm = TRUE), .groups = 'drop')
View(cornwallHousePrice_2022_2023)
bristolSchools_2022_2023 = bristolSchools %>%
filter(Year == 2022 | Year == 2023) %>%
filter(ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR)) %>%
group_by(POSTCODE) %>%
summarise(Avg_ATT8SCR = mean(ATT8SCR, na.rm = TRUE), .groups = 'drop')
View(bristolSchools_2022_2023)
cornwallSchools_2022_2023 = cornwallSchools %>%
filter(Year == 2022 | Year == 2023) %>%
filter(ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR)) %>%
group_by(POSTCODE) %>%
summarise(Avg_ATT8SCR = mean(ATT8SCR, na.rm = TRUE), .groups = 'drop')
View(cornwallSchools_2022_2023)
bs_housePrice_att8scr_2022_2023 = inner_join(bristolHousePrice_2022_2023, bristolSchools_2022_2023,
by = c("Postcode" = "POSTCODE")) %>%
select(Price, ATT8SCR)
bs_housePrice_att8scr_2022_2023 = inner_join(bristolHousePrice_2022_2023, bristolSchools_2022_2023,
by = c("Postcode" = "POSTCODE")) %>%
select(Avg_Price, Avg_ATT8SCR)
View(bs_housePrice_att8scr_2022_2023)
bs_housePrice_att8scr_2022_2023 %>%
summarise(corCoeff = cor(Avg_Price, Avg_ATT8SCR))
bsModel_housePrice_att8scr_2022_2023 = lm(Avg_Price ~ Avg_ATT8SCR,
data = bs_housePrice_att8scr_2022_2023)
summary(bsModel_housePrice_att8scr_2022_2023)
bsIntercept_housePrice_att8scr_2022_2023 = coef(bsModel_housePrice_att8scr_2022_2023)[1]
bsSlope_housePrice_att8scr_2022_2023 = coef(bsModel_housePrice_att8scr_2022_2023)[2]
ggplot(bsModel_housePrice_att8scr_2022_2023, aes(x = Avg_ATT8SCR, y = Avg_Price)) +
geom_point(color = "blue", size = 2) +
geom_abline(intercept = bsIntercept_housePrice_att8scr_2022_2023, slope = bsSlope_housePrice_att8scr_2022_2023, color = "red") +
labs(
title = "Influence of Attainment 8 Scores on House Price in Bristol (2022-2023)",
x = "Attainment 8 Scores (average)",
y = "House Price (average)"
) +
theme_minimal()
options(scipen = 1000)
ggplot(bsModel_housePrice_att8scr_2022_2023, aes(x = Avg_ATT8SCR, y = Avg_Price)) +
geom_point(color = "blue", size = 2) +
geom_abline(intercept = bsIntercept_housePrice_att8scr_2022_2023, slope = bsSlope_housePrice_att8scr_2022_2023, color = "red") +
labs(
title = "Influence of Attainment 8 Scores on House Price in Bristol (2022-2023)",
x = "Attainment 8 Scores (average)",
y = "House Price (average)"
) +
theme_minimal()
#FOR CORNWALL
cw_housePrice_att8scr_2022_2023 = inner_join(cornwallHousePrice_2022_2023, cornwallSchools_2022_2023,
by = c("Postcode" = "POSTCODE")) %>%
select(Avg_Price, Avg_ATT8SCR)
View(cw_housePrice_att8scr_2022_2023)
#FOR CORNWALL
cw_housePrice_att8scr_2022_2023 = inner_join(cornwallHousePrice_2022_2023, cornwallSchools_2022_2023,
by = c("Postcode" = "POSTCODE"))
View(cw_housePrice_att8scr_2022_2023)
cornwallSchools_2022_2023 = cornwallSchools %>%
filter(Year == 2022 | Year == 2023) %>%
filter(ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR))
cornwallHousePrice_2022_2023 = cornwallHousePrice %>%
filter(year(Date_of_transfer) == 2022 | year(Date_of_transfer) == 2023) %>%
View(cornwallHousePrice_2022_2023)
cornwallHousePrice_2022_2023 = cornwallHousePrice %>%
filter(year(Date_of_transfer) == 2022 | year(Date_of_transfer) == 2023) %>%
View(cornwallHousePrice_2022_2023)
cornwallHousePrice_2022_2023 = cornwallHousePrice %>%
filter(year(Date_of_transfer) == 2022 | year(Date_of_transfer) == 2023)
#FOR CORNWALL
cw_housePrice_att8scr_2022_2023 = inner_join(cornwallHousePrice_2022_2023, cornwallSchools_2022_2023,
by = c("Postcode" = "POSTCODE"))
View(cw_housePrice_att8scr_2022_2023)
#FOR CORNWALL
cw_housePrice_att8scr_2022_2023 = inner_join(cornwallHousePrice_2022_2023, cornwallSchools_2022_2023,
by = c("Postcode" = "POSTCODE"))
cornwallHousePrice_2022_2023 = cornwallHousePrice %>%
filter(year(Date_of_transfer) == 2022 | year(Date_of_transfer) == 2023) %>%
group_by(Postcode) %>%
summarise(Avg_Price = mean(Price, na.rm = TRUE), .groups = 'drop')
cornwallSchools_2022_2023 = cornwallSchools %>%
filter(Year == 2022 | Year == 2023) %>%
filter(ATT8SCR != "SUPP" & ATT8SCR != "NE") %>%
mutate(ATT8SCR = as.numeric(ATT8SCR)) %>%
group_by(POSTCODE) %>%
summarise(Avg_ATT8SCR = mean(ATT8SCR, na.rm = TRUE), .groups = 'drop')
#FOR CORNWALL
cw_housePrice_att8scr_2022_2023 = inner_join(cornwallHousePrice_2022_2023, cornwallSchools_2022_2023,
by = c("Postcode" = "POSTCODE"))
View(cw_housePrice_att8scr_2022_2023)
#FOR CORNWALL
cw_housePrice_att8scr_2022_2023 = inner_join(cornwallHousePrice_2022_2023, cornwallSchools_2022_2023,
by = c("Postcode" = "POSTCODE")) %>%
select(Avg_Price, Avg_ATT8SCR)
View(cw_housePrice_att8scr_2022_2023)
#Weak, negative relationship (-0.291)
cw_housePrice_att8scr_2022_2023 %>%
summarise(corCoeff = cor(Avg_Price, Avg_ATT8SCR))
cwModel_housePrice_att8scr_2022_2023 = lm(Avg_Price ~ Avg_ATT8SCR,
data = cw_housePrice_att8scr_2022_2023)
summary(cwModel_housePrice_att8scr_2022_2023)
cwIntercept_housePrice_att8scr_2022_2023 = coef(cwModel_housePrice_att8scr_2022_2023)[1]
cwSlope_housePrice_att8scr_2022_2023 = coef(cwModel_housePrice_att8scr_2022_2023)[2]
ggplot(cwModel_housePrice_att8scr_2022_2023, aes(x = Avg_ATT8SCR, y = Avg_Price)) +
geom_point(color = "blue", size = 2) +
geom_abline(intercept = cwIntercept_housePrice_att8scr_2022_2023, slope = cwSlope_housePrice_att8scr_2022_2023, color = "red") +
labs(
title = "Influence of Attainment 8 Scores on House Price in Cornwall (2022-2023)",
x = "Attainment 8 Scores (average)",
y = "House Price (average)"
) +
theme_minimal()
#Plot radar chart
radarchart(radar_data,
axistype = 1,
pcol = c("blue", "red"),
pfcol = c("blue", "red"),
plwd = 2,
cglcol = "grey",
cglty = 1,
axislabcol = "grey",
vlcex = 0.8,
title = "Vehicle Crime Rate per 10,000 People in Bristol and Cornwall (Nov 2022)",
cex.main = 1)
